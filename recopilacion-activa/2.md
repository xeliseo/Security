# Descubrimiento con NMAP

Para utilizar esta técnica es necesario realizar un monitoreo del puerto eth0 con wireshark 

## Comando nmap

**nmap -sn <host>**: 
Internamente lo que hace es realizar el envío de paquetes al puerto 80 y 443 mediante el protocolo TCP, si este responde quiere decir que el host está disponible.

Ejemplo: `nmap -sn 192.168.56.101`
> Al parecer ahora todos funcionan con ARP

**sudo nmap -sn <host>**:
Se realiza un descubrimiento utilizando el protocolo ARP (Leer el protocolo ARP). Por lo que entendí, hace una especie de broadcast a todos los dispositivos conectados a la red. Esto es menos intrusivo que el comando anterior.

Ejemplo: `sudo nmap -sn 192.168.56.101`

**sudo nmap -sn <red/bytes>**:
Se realiza un descubrimiento de todos los host disponibles en un red mediante el protocol ARP.

Ejemplo: `sudo nmap -sn 192.168.56.0/24`

**nmap -PS <host>**:
Escaneo de puertos del host. Luego de verificar que el host está levantado con el protocolo ARP, el mismo empieza a realizar peticiones TCP a una gran cantidad de puertos del host para comprobar cuales esta descubiertos.

**nmap -PS <host> -p <port>**:
Restringe la comprobación del host realizando peticiones solamente a un puerto determinado.

**nmap -PS<port> <host> -p <port>**:
Con el primer <port> lo utiliza para verificar que el servidor esté levantado, al segundo realiza simplemente el escaneo.

**nmap -PS<port1>,<port2>,<port3> <host> -p <port>**:
Realizar consultas TCP a los puertos 1, 2 y 3 para verificar que el servidor esté levantado y realiza el escaneo del puerto <port>.

## Analisis/Escaneo de puertos

**sudo nmap -sS <host> -p <port>**:
Realiza el escaneo de un puerto de un nodo:
1. Trata de identificar mediante ARP si el host está levantado o no
2. Luego mediante TCP valida comprueba que el puerto está abierto (Leer la documentación de nmap para entender la interacción a bajo nivel)

Ejemplo: `sudo nmap -sS 192.168.56.101 -p 80`

**sudo nmap -sS <host>**:
Realiza un escaneo de todos los puertos de un nodo.

Ejemplo: `sudo nmap -sS 192.158.56.101`

**sudo nmap -sS <red/bytes>**:
Realiza un escaneo de todos los puertos de todos los nodos disponibles en un segmento de red.

Ejemplo: `sudo nmap -sS 192.168.56/24`

**sudo nmap -sS <host-[range]>**:
Realiza un escaneo de solamente los nodos disponibles en el segmento de red que están dentro del range de IP.

Ejemplo: `sudo nmap -sS 192.168.56.100-105`

**sudo nmap -v --reason -oX </path/file.xml> --stylesheet="https://svn.nmap.org/nmap/docs/nmap.xsl" -sS <host>**:
    
Ejemplo: `sudo nmap -v --reason -oX ./report.xml --stylesheet="https://svn.nmap.org/nmap/docs/nmap.xsl -sS 192.168.56.101-105`

- `-v`: (verbose), mostrar más información sobre cada acción
- `--reason`: razón por la que el puerto está descubierto
- `-ox </path/your/file.xml> --stylesheet="<url>"`: Reportar en un archivo con extensión xml usando la hoja de estilos especificada


**sudo nmap -sT <host> -p <port>**:
Este comando es igual a `-sS` solamente que realiza más interacciones con el nodo objetivo.

**sudo nmap -sU <host> -p <port>**:
Comando para puertos que utilizan el protolo UDP. Se comunica con el puerto utilizando UDP y no TCP.
