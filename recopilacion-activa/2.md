# Descubrimiento con NMAP

Nmap (Network Mapper) es la herramienta estándar para descubrimiento de redes y auditoría de seguridad. Permite identificar hosts activos, puertos abiertos, servicios en ejecución y sistemas operativos.

> **Tip:** Para observar el tráfico de red generado por nmap, monitorea la interfaz de red (ej: `eth0`) con Wireshark.

---

## Descubrimiento de hosts (-sn)

El flag `-sn` (anteriormente `-sP`) realiza un "ping scan" para determinar qué hosts están activos **sin escanear puertos**.

### Sin privilegios de root

```bash
nmap -sn <host>
```

Envía paquetes TCP SYN al puerto 443 y TCP ACK al puerto 80. Si recibe respuesta (SYN/ACK o RST), el host está activo.

Ejemplo: `nmap -sn 192.168.56.101`

> **Nota:** En redes locales, nmap detecta que es más eficiente usar ARP y lo utiliza automáticamente.

---

### Con privilegios de root (recomendado en LAN)

```bash
sudo nmap -sn <host>
```

Utiliza **ARP requests** para el descubrimiento. ARP opera en capa 2 (enlace de datos), lo que lo hace más rápido y confiable en redes locales ya que no puede ser bloqueado por firewalls de capa 3.

Ejemplo: `sudo nmap -sn 192.168.56.101`

---

### Escaneo de toda una subred

```bash
sudo nmap -sn <red>/<cidr>
```

Descubre todos los hosts activos en un segmento de red usando ARP.

Ejemplo: `sudo nmap -sn 192.168.56.0/24`

---

## Descubrimiento con TCP SYN Ping (-PS)

El flag `-PS` envía paquetes TCP SYN a puertos específicos para determinar si un host está activo. Es útil cuando ICMP está bloqueado.

```bash
nmap -PS <host>
```

Primero verifica si el host está activo (vía ARP en LAN), luego escanea los 1000 puertos TCP más comunes.

---

```bash
nmap -PS <host> -p <port>
```

Limita el escaneo de puertos únicamente al puerto especificado.

---

```bash
nmap -PS<port> <host> -p <port>
```

- El puerto después de `-PS` se usa para la **fase de descubrimiento** (verificar si el host está activo)
- El puerto después de `-p` es el que se **escanea**

---

```bash
nmap -PS<port1>,<port2>,<port3> <host> -p <port>
```

Usa múltiples puertos (separados por coma, sin espacios) para verificar que el host esté activo, luego escanea el puerto indicado con `-p`.

---

## Escaneo de puertos

### TCP SYN Scan (-sS) - "Half-open scan"

Es el escaneo por defecto y más popular. Se llama "half-open" porque no completa el handshake TCP de 3 vías:

1. Nmap envía SYN
2. Si recibe SYN/ACK → puerto **abierto** (envía RST para cerrar)
3. Si recibe RST → puerto **cerrado**
4. Sin respuesta → puerto **filtrado**

Requiere privilegios de root.

```bash
sudo nmap -sS <host> -p <port>
```

Ejemplo: `sudo nmap -sS 192.168.56.101 -p 80`

---

```bash
sudo nmap -sS <host>
```

Escanea los 1000 puertos TCP más comunes del host.

Ejemplo: `sudo nmap -sS 192.168.56.101`

---

```bash
sudo nmap -sS <red>/<cidr>
```

Escanea todos los hosts de una subred.

Ejemplo: `sudo nmap -sS 192.168.56.0/24`

---

```bash
sudo nmap -sS <host_inicio>-<host_fin>
```

Escanea un rango específico de hosts.

Ejemplo: `sudo nmap -sS 192.168.56.100-105`

---

### Escaneo con salida a archivo y opciones avanzadas

```bash
sudo nmap -v --reason -oX </path/file.xml> --stylesheet="https://svn.nmap.org/nmap/docs/nmap.xsl" -sS <host>
```

Ejemplo: `sudo nmap -v --reason -oX ./report.xml --stylesheet="https://svn.nmap.org/nmap/docs/nmap.xsl" -sS 192.168.56.101-105`

| Flag | Descripción |
|------|-------------|
| `-v` | Modo verbose, muestra más detalles durante el escaneo |
| `--reason` | Indica la razón por la que nmap determina el estado de cada puerto |
| `-oX <file>` | Exporta los resultados en formato XML |
| `--stylesheet` | Aplica una hoja de estilos XSL para visualizar el XML en un navegador |

---

### TCP Connect Scan (-sT)

```bash
sudo nmap -sT <host> -p <port>
```

Realiza el handshake TCP completo (SYN → SYN/ACK → ACK). Es más lento y detectable que `-sS`, pero no requiere privilegios de root. Útil cuando no tienes acceso a raw sockets.

---

### UDP Scan (-sU)

```bash
sudo nmap -sU <host> -p <port>
```

Escanea puertos UDP. Es más lento que TCP porque UDP no tiene confirmación de recepción. Envía paquetes UDP vacíos (o específicos del protocolo) y espera respuestas ICMP "port unreachable" para determinar puertos cerrados.

---

### Detección de versiones (-sV)

```bash
sudo nmap -sV <host> -p <port>
```

Además de detectar si el puerto está abierto, **interroga al servicio** para determinar:
- Nombre del servicio (http, ssh, ftp, etc.)
- Versión específica del software
- Información adicional (ej: "OpenSSH 7.9")

---

### Ejemplo combinado con detección de versiones

```bash
sudo nmap -v --reason -sV -oX servicios.xml --stylesheet="https://svn.nmap.org/nmap/docs/nmap.xsl" 192.168.56.101-102
```

| Flag | Descripción |
|------|-------------|
| `-v` | Modo verbose |
| `--reason` | Muestra por qué el puerto tiene ese estado |
| `-sV` | Detecta versión del servicio |
| `-oX` | Exporta a XML |
| `--stylesheet` | Hoja de estilos para visualización |
| `192.168.56.101-102` | Rango de hosts a escanear |


---

## Identificación del sistema operativo (-O)

```bash
sudo nmap -v -O <host>
```

Nmap analiza las respuestas de la pila TCP/IP del objetivo para hacer fingerprinting del sistema operativo. Examina características como:
- Valores iniciales de TTL
- Tamaño de ventana TCP
- Opciones TCP y su orden
- Respuestas a paquetes malformados

Ejemplo: `sudo nmap -v -O 192.168.56.102`

---

## Protocolo SMB

### Concepto

**SMB (Server Message Block)** es un protocolo de red utilizado principalmente en Windows para compartir recursos en red:
- Archivos y carpetas
- Impresoras
- Puertos seriales

### Evolución y seguridad

| Versión | Sistema Operativo | Notas |
|---------|-------------------|-------|
| SMBv1 | Windows 2000, XP, Server 2003 | Múltiples vulnerabilidades críticas (EternalBlue, WannaCry) |
| SMBv2 | Windows Vista, Server 2008 | Mejoras de rendimiento y seguridad |
| SMBv2.1 | Windows 7 | Optimizaciones adicionales |
| SMBv3 | Windows 8+ | Cifrado end-to-end, firmas mejoradas |

> **Nota de seguridad:** SMBv1 está obsoleto y debe estar deshabilitado. Es el vector de ataques como EternalBlue (MS17-010).

### Puertos SMB

- **Puerto 139**: NetBIOS Session Service (SMB sobre NetBIOS)
- **Puerto 445**: SMB directo sobre TCP/IP (sin NetBIOS)

### Escaneo básico de SMB

```bash
sudo nmap -v -sS -p 139,445 <host>
```

Ejemplo: `sudo nmap -v -sS -p 139,445 192.168.56.102`

---

## NSE - Nmap Scripting Engine

Nmap incluye un motor de scripts (NSE) con cientos de scripts para automatizar tareas de reconocimiento, detección de vulnerabilidades y más.

**Ubicación de scripts:** `/usr/share/nmap/scripts/`

### Comandos útiles para explorar scripts

```bash
# Listar scripts relacionados con SMB
ls /usr/share/nmap/scripts/ | grep -i smb

# Ver ayuda de un script específico
nmap --script-help smb-os-discovery
```

### Scripts SMB útiles

**Descubrir sistema operativo vía SMB:**

```bash
sudo nmap -v -sS -p 139,445 --script=smb-os-discovery <host>
```

Ejemplo: `sudo nmap -v -sS -p 139,445 --script=smb-os-discovery 192.168.56.102`

---

**Enumerar carpetas compartidas:**

```bash
sudo nmap -v -sS -p 139,445 --script=smb-enum-shares <host>
```

Ejemplo: `sudo nmap -v -sS -p 139,445 --script=smb-enum-shares 192.168.56.102`

```
Host script results:
| smb-enum-shares:
|   note: ERROR: Enumerating shares failed, guessing at common ones (NT_STATUS_ACCESS_DENIED)
|   account_used: <blank>
|   \\192.168.56.102\ADMIN$:
|     warning: Couldn't get details for share: NT_STATUS_ACCESS_DENIED
|     Anonymous access: <none>
|   \\192.168.56.102\C$:
|     warning: Couldn't get details for share: NT_STATUS_ACCESS_DENIED
|     Anonymous access: <none>
|   \\192.168.56.102\IPC$:
|     warning: Couldn't get details for share: NT_STATUS_ACCESS_DENIED
|     Anonymous access: READ
|   \\192.168.56.102\USERS:
|     warning: Couldn't get details for share: NT_STATUS_ACCESS_DENIED
|_    Anonymous access: <none>
```

---

**Enumerar usuarios:**

```bash
sudo nmap -v -sS -p 139,445 --script=smb-enum-users <host>
```

Ejemplo: `sudo nmap -v -sS -p 139,445 --script=smb-enum-users 192.168.56.102`

> **Nota:** Este script puede fallar si el servidor tiene habilitada la restricción de acceso anónimo.

---

## Protocolo SNMP

### Concepto

**SNMP (Simple Network Management Protocol)** es un protocolo de capa de aplicación utilizado para monitorear y gestionar dispositivos de red:
- Routers y switches
- Servidores
- Impresoras
- UPS
- Cualquier dispositivo con agente SNMP

### Puerto y protocolo

- **Puerto 161/UDP**: Consultas SNMP (GET, SET)
- **Puerto 162/UDP**: Traps SNMP (notificaciones asíncronas)

> **Importante:** SNMP utiliza **UDP**, no TCP. Un error común es escanearlo con TCP.

### Componentes SNMP

- **Community String**: Actúa como contraseña. Por defecto suele ser `public` (lectura) o `private` (escritura)
- **MIB (Management Information Base)**: Base de datos jerárquica con información del dispositivo
- **OID (Object Identifier)**: Identificador único para cada objeto en la MIB

### Escaneo SNMP

**Error común - escaneo TCP:**

```bash
sudo nmap -v -sS -p 161 192.168.56.102
```

```
PORT    STATE  SERVICE
161/tcp closed snmp
```

> El puerto aparece cerrado porque SNMP usa UDP, no TCP.

---

**Escaneo correcto - UDP:**

```bash
sudo nmap -v -sU -p 161 192.168.56.102
```

```
PORT    STATE SERVICE
161/udp open  snmp
```

> **Nota:** Los scripts SNMP de nmap son muy útiles para extraer información de sistemas Windows mal configurados con community strings por defecto.

---

### Scripts SNMP útiles

**Listar software instalado:**

```bash
sudo nmap -v -sU -p 161 --script=snmp-win32-software <host>
```

Ejemplo: `sudo nmap -v -sU -p 161 --script=snmp-win32-software 192.168.56.102`

```
PORT    STATE SERVICE
161/udp open  snmp
| snmp-win32-software:
|   7-Zip 22.01 (x64); 2023-03-19T02:22:16
|   Java 8 Update 251 (64-bit); 2023-03-19T02:23:56
|   Java SE Development Kit 8 Update 211 (64-bit); 2023-03-19T02:25:46
|   Microsoft .NET Framework 4.5.2; 2023-03-19T02:12:48
|   Microsoft .NET Framework 4.5.2; 2023-03-19T02:12:44
|   Microsoft Visual C++ 2008 Redistributable - x64 9.0.30729.6161; 2023-03-19T02:27:48
|   OpenSSH for Windows 7.1p1-1 (remove only); 2023-03-19T02:06:06
|_  Oracle VM VirtualBox Guest Additions 6.0.8; 2023-03-19T02:45:06
```

---

**Listar usuarios del sistema:**

```bash
sudo nmap -v -sU -p 161 --script=snmp-win32-users <host>
```

Ejemplo: `sudo nmap -v -sU -p 161 --script=snmp-win32-users 192.168.56.102`

```
PORT    STATE SERVICE
161/udp open  snmp
| snmp-win32-users:
|   Administrator
|   Guest
|   anakin_skywalker
|   artoo_detoo
|   ben_kenobi
|   boba_fett
|   c_three_pio
|   chewbacca
|   darth_vader
|   greedo
|   han_solo
|   jabba_hutt
|   jarjar_binks
|   kylo_ren
|   lando_calrissian
|   leia_organa
|   luke_skywalker
|   sshd
|   sshd_server
|_  vagrant
```

---

**Listar procesos en ejecución:**

```bash
sudo nmap -v -sU -p 161 --script=snmp-processes <host>
```

Ejemplo: `sudo nmap -v -sU -p 161 --script=snmp-processes 192.168.56.102`
```
PORT    STATE SERVICE
161/udp open  snmp
| snmp-processes: 
|   1: 
|     Name: System Idle Process
|   4: 
|     Name: System
|   204: 
|     Name: dwm.exe
|     Path: C:\Windows\system32\
|   252: 
|     Name: smss.exe
|     Path: \SystemRoot\System32\
|   328: 
|     Name: csrss.exe
|     Path: %SystemRoot%\system32\
|     Params: ObjectDirectory=\Windows SharedSection=1024,20480,768 Windows=On SubSystemType=Windows ServerDll=basesrv,1 ServerDll=winsrv:User
|   372: 
|     Name: wininit.exe
|   392: 
|     Name: csrss.exe
|     Path: %SystemRoot%\system32\
|     Params: ObjectDirectory=\Windows SharedSection=1024,20480,768 Windows=On SubSystemType=Windows ServerDll=basesrv,1 ServerDll=winsrv:User
|   428: 
|     Name: winlogon.exe
|   464: 
|     Name: svchost.exe
|   476: 
|     Name: services.exe
|     Path: C:\Windows\system32\
|   484: 
|     Name: lsass.exe
|     Path: C:\Windows\system32\
|   492: 
|     Name: lsm.exe
|     Path: C:\Windows\system32\
|   588: 
|     Name: svchost.exe
|   652: 
|     Name: VBoxService.exe
|     Path: C:\Windows\System32\
|   720: 
|     Name: svchost.exe
|   808: 
|     Name: svchost.exe
|   856: 
|     Name: svchost.exe
|   912: 
|     Name: svchost.exe
|   956: 
|     Name: svchost.exe
|   988: 
|     Name: dcrotatelogs.exe
|     Path: C:\ManageEngine\DesktopCentral_Server\apache\bin\
|     Params: -l C:/ManageEngine/DesktopCentral_Server/logs/apache_errorlog_%Y-%m-%d-%H_%M.txt 5M
|   996: 
|     Name: svchost.exe
|   1072: 
|     Name: spoolsv.exe
|   1100: 
|     Name: svchost.exe
|   1128: 
|     Name: wrapper.exe
|   1152: 
|     Name: conhost.exe
|     Path: \??\C:\Windows\system32\
|   1236: 
|     Name: conhost.exe
|     Path: \??\C:\Windows\system32\
|   1244: 
|     Name: domain1Service.exe
|   1312: 
|     Name: dcserverhttpd.exe
|     Path: C:\ManageEngine\DesktopCentral_Server\apache\bin\
|     Params: -d C:/ManageEngine/DesktopCentral_Server/apache
|   1332: 
|     Name: elasticsearch-service-x64.exe
|     Path: C:\Program Files\elasticsearch-1.1.1\bin\
|     Params:  //RS//elasticsearch-service-x64
|   1340: 
|     Name: conhost.exe
|     Path: \??\C:\Windows\system32\
|   1360: 
|     Name: DesktopCentral.exe
|     Path: C:\ManageEngine\DesktopCentral_Server\bin\
|     Params:  
|   1376: 
|     Name: svchost.exe
|   1400: 
|     Name: jenkins.exe
|   1448: 
|     Name: cmd.exe
|     Params: /c ""C:/glassfish/glassfish4/glassfish/lib/nadmin.bat"  start-domain --watchdog --domaindir C:\\glassfish\\glassfish4\\glassfish
|   1456: 
|     Name: conhost.exe
|     Path: \??\C:\Windows\system32\
|   1500: 
|     Name: java.exe
|   1520: 
|     Name: java.exe
|     Params:  -jar "C:\glassfish\glassfish4\glassfish\lib\..\modules\admin-cli.jar" start-domain --watchdog --domaindir C:\\glassfish\\glassf
|   1556: 
|     Name: conhost.exe
|     Path: \??\C:\Windows\system32\
|   1740: 
|     Name: jmx.exe
|   1768: 
|     Name: conhost.exe
|     Path: \??\C:\Windows\system32\
|   1824: 
|     Name: dcnotificationserver.exe
|   1872: 
|     Name: dcserverhttpd.exe
|   1988: 
|     Name: java.exe
|     Path: C:\Program Files (x86)\Common Files\Oracle\Java\javapath\
|     Params:  -jar "C:\Program Files\jenkins\jenkins.war" --httpPort=8484
|   1996: 
|     Name: cmd.exe
|     Path: C:\Windows\system32\
|     Params:   /c "C:\Program Files\jmx\start_jmx.bat"
|   2012: 
|     Name: conhost.exe
|     Path: \??\C:\Windows\system32\
|   2024: 
|     Name: java.exe
|     Path: C:\openjdk6\openjdk-1.6.0-unofficial-b27-windows-amd64\jre\bin\
|     Params:   -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=1617 -Dcom.sun.management.jmxremote.authenticate=false -Dco
|   2072: 
|     Name: dcrotatelogs.exe
|     Path: C:\ManageEngine\DesktopCentral_Server\apache\bin\
|     Params: -l C:/ManageEngine/DesktopCentral_Server/logs/apache_errorlog_%Y-%m-%d-%H_%M.txt 5M
|   2084: 
|     Name: conhost.exe
|     Path: \??\C:\Windows\system32\
|   2904: 
|     Name: cygrunsrv.exe
|     Path: C:\Program Files\OpenSSH\bin\
|   2948: 
|     Name: java.exe
|   2968: 
|     Name: conhost.exe
|     Path: \??\C:\Windows\system32\
|   3016: 
|     Name: svchost.exe
|   3096: 
|     Name: sshd.exe
|     Path: C:\Program Files\OpenSSH\usr\sbin\
|   3116: 
|     Name: snmp.exe
|     Path: C:\Windows\System32\
|   3200: 
|     Name: tomcat8.exe
|     Path: C:\Program Files\Apache Software Foundation\tomcat\apache-tomcat-8.0.33\bin\
|     Params:  //RS//Tomcat8
|   3212: 
|     Name: conhost.exe
|     Path: \??\C:\Windows\system32\
|   3260: 
|     Name: sppsvc.exe
|   3328: 
|     Name: httpd.exe
|   3412: 
|     Name: mysqld.exe
|     Path: c:\wamp\bin\mysql\mysql5.5.20\bin\
|     Params: wampmysqld
|   3436: 
|     Name: svchost.exe
|     Path: C:\Windows\system32\
|     Params: -k iissvcs
|   3468: 
|     Name: wlms.exe
|     Path: C:\Windows\system32\wlms\
|   3488: 
|     Name: httpd.exe
|     Path: C:\wamp\bin\apache\apache2.2.21\bin\
|     Params: -d C:/wamp/bin/apache/Apache2.2.21
|   3892: 
|     Name: VBoxTray.exe
|     Path: C:\Windows\System32\
|     Params:  
|   3944: 
|     Name: explorer.exe
|     Path: C:\Windows\
|   4180: 
|     Name: svchost.exe
|   4188: 
|     Name: msdtc.exe
|   4292: 
|     Name: svchost.exe
|   4584: 
|     Name: taskhost.exe
|   4620: 
|_    Name: svchost.exe
```

---

**Listar conexiones de red (netstat):**

```bash
sudo nmap -v -sU -p 161 --script=snmp-netstat <host>
```

Ejemplo: `sudo nmap -v -sU -p 161 --script=snmp-netstat 192.168.56.102`

```
PORT    STATE SERVICE
161/udp open  snmp
| snmp-netstat:
|   TCP  0.0.0.0:22           0.0.0.0:0
|   TCP  0.0.0.0:135          0.0.0.0:0
|   TCP  0.0.0.0:3306         0.0.0.0:0
|   TCP  0.0.0.0:3389         0.0.0.0:0
|   TCP  0.0.0.0:8009         0.0.0.0:0
|   TCP  0.0.0.0:8020         0.0.0.0:0
|   TCP  0.0.0.0:8027         0.0.0.0:0
|   TCP  0.0.0.0:8282         0.0.0.0:0
|   TCP  0.0.0.0:8383         0.0.0.0:0
|   TCP  0.0.0.0:8585         0.0.0.0:0
|   TCP  0.0.0.0:49152        0.0.0.0:0
|   TCP  0.0.0.0:49153        0.0.0.0:0
|   TCP  0.0.0.0:49154        0.0.0.0:0
|   TCP  0.0.0.0:49157        0.0.0.0:0
|   TCP  0.0.0.0:49201        0.0.0.0:0
|   TCP  0.0.0.0:49248        0.0.0.0:0
|   TCP  127.0.0.1:8005       0.0.0.0:0
|   TCP  127.0.0.1:31000      127.0.0.1:32000
|   TCP  127.0.0.1:32000      0.0.0.0:0
|   TCP  127.0.0.1:32000      127.0.0.1:31000
|   TCP  127.0.0.1:49158      127.0.0.1:49159
|   TCP  127.0.0.1:49159      127.0.0.1:49158
|   TCP  127.0.0.1:49160      127.0.0.1:49161
|   TCP  127.0.0.1:49161      127.0.0.1:49160
|   TCP  127.0.0.1:49162      127.0.0.1:49163
|   TCP  127.0.0.1:49163      127.0.0.1:49162
|   TCP  127.0.0.1:49164      127.0.0.1:49165
|   TCP  127.0.0.1:49165      127.0.0.1:49164
|   TCP  127.0.0.1:49166      127.0.0.1:49167
|   TCP  127.0.0.1:49167      127.0.0.1:49166
|   TCP  127.0.0.1:49168      127.0.0.1:49169
|   TCP  127.0.0.1:49169      127.0.0.1:49168
|   TCP  127.0.0.1:49170      127.0.0.1:49171
|   TCP  127.0.0.1:49171      127.0.0.1:49170
|   TCP  127.0.0.1:49172      127.0.0.1:49173
|   TCP  127.0.0.1:49173      127.0.0.1:49172
|   TCP  127.0.0.1:49174      127.0.0.1:49175
|   TCP  127.0.0.1:49175      127.0.0.1:49174
|   TCP  127.0.0.1:49176      127.0.0.1:49177
|   TCP  127.0.0.1:49177      127.0.0.1:49176
|   TCP  127.0.0.1:49178      127.0.0.1:49179
|   TCP  127.0.0.1:49179      127.0.0.1:49178
|   TCP  127.0.0.1:49193      127.0.0.1:49194
|   TCP  127.0.0.1:49194      127.0.0.1:49193
|   TCP  127.0.0.1:49195      127.0.0.1:49196
|   TCP  127.0.0.1:49196      127.0.0.1:49195
|   TCP  127.0.0.1:49197      127.0.0.1:49198
|   TCP  127.0.0.1:49198      127.0.0.1:49197
|   TCP  127.0.0.1:49199      127.0.0.1:49200
|   TCP  127.0.0.1:49200      127.0.0.1:49199
|   TCP  127.0.0.1:49202      127.0.0.1:49203
|   TCP  127.0.0.1:49203      127.0.0.1:49202
|   TCP  127.0.0.1:49204      127.0.0.1:49205
|   TCP  127.0.0.1:49205      127.0.0.1:49204
|   TCP  127.0.0.1:49206      127.0.0.1:49207
|   TCP  127.0.0.1:49207      127.0.0.1:49206
|   TCP  127.0.0.1:49208      127.0.0.1:49209
|   TCP  127.0.0.1:49209      127.0.0.1:49208
|   TCP  127.0.0.1:49210      127.0.0.1:49211
|   TCP  127.0.0.1:49211      127.0.0.1:49210
|   TCP  127.0.0.1:49212      127.0.0.1:49213
|   TCP  127.0.0.1:49213      127.0.0.1:49212
|   TCP  127.0.0.1:49214      127.0.0.1:49215
|   TCP  127.0.0.1:49215      127.0.0.1:49214
|   TCP  127.0.0.1:49216      127.0.0.1:49217
|   TCP  127.0.0.1:49217      127.0.0.1:49216
|   TCP  127.0.0.1:49218      127.0.0.1:49219
|   TCP  127.0.0.1:49219      127.0.0.1:49218
|   TCP  127.0.0.1:49220      127.0.0.1:49221
|   TCP  127.0.0.1:49221      127.0.0.1:49220
|   TCP  127.0.0.1:49222      127.0.0.1:49223
|   TCP  127.0.0.1:49223      127.0.0.1:49222
|   TCP  127.0.0.1:49224      127.0.0.1:49225
|   TCP  127.0.0.1:49225      127.0.0.1:49224
|   TCP  127.0.0.1:49226      127.0.0.1:49227
|   TCP  127.0.0.1:49227      127.0.0.1:49226
|   TCP  127.0.0.1:49228      127.0.0.1:49229
|   TCP  127.0.0.1:49229      127.0.0.1:49228
|   TCP  127.0.0.1:49230      127.0.0.1:49231
|   TCP  127.0.0.1:49231      127.0.0.1:49230
|   TCP  127.0.0.1:49232      127.0.0.1:49233
|   TCP  127.0.0.1:49233      127.0.0.1:49232
|   TCP  127.0.0.1:49234      127.0.0.1:49235
|   TCP  127.0.0.1:49235      127.0.0.1:49234
|   TCP  127.0.0.1:49236      127.0.0.1:49237
|   TCP  127.0.0.1:49237      127.0.0.1:49236
|   TCP  127.0.0.1:49238      127.0.0.1:49239
|   TCP  127.0.0.1:49239      127.0.0.1:49238
|   TCP  127.0.0.1:49240      127.0.0.1:49241
|   TCP  127.0.0.1:49241      127.0.0.1:49240
|   TCP  127.0.0.1:49242      127.0.0.1:49243
|   TCP  127.0.0.1:49243      127.0.0.1:49242
|   TCP  127.0.0.1:49244      127.0.0.1:49245
|   TCP  127.0.0.1:49245      127.0.0.1:49244
|   TCP  127.0.0.1:49246      127.0.0.1:49247
|   TCP  127.0.0.1:49247      127.0.0.1:49246
|   TCP  127.0.0.1:49249      127.0.0.1:49250
|   TCP  127.0.0.1:49250      127.0.0.1:49249
|   TCP  127.0.0.1:49251      127.0.0.1:49252
|   TCP  127.0.0.1:49252      127.0.0.1:49251
|   TCP  127.0.0.1:49253      127.0.0.1:49254
|   TCP  127.0.0.1:49254      127.0.0.1:49253
|   TCP  127.0.0.1:49255      127.0.0.1:49256
|   TCP  127.0.0.1:49256      127.0.0.1:49255
|   TCP  127.0.0.1:49583      127.0.0.1:8020
|   TCP  127.0.0.1:49584      127.0.0.1:8020
|   TCP  127.0.0.1:49585      127.0.0.1:8020
|   TCP  127.0.0.1:49586      127.0.0.1:8020
|   TCP  127.0.0.1:49587      127.0.0.1:8020
|   TCP  127.0.0.1:49588      127.0.0.1:8020
|   TCP  127.0.0.1:49589      127.0.0.1:8020
|   TCP  127.0.0.1:49590      127.0.0.1:8020
|   TCP  127.0.0.1:49591      127.0.0.1:8020
|   TCP  127.0.0.1:49592      127.0.0.1:8020
|   TCP  127.0.0.1:49593      127.0.0.1:8020
|   TCP  127.0.0.1:49594      127.0.0.1:8020
|   TCP  127.0.0.1:49595      127.0.0.1:8020
|   TCP  127.0.0.1:49596      127.0.0.1:8020
|   TCP  127.0.0.1:49597      127.0.0.1:8020
|   TCP  127.0.0.1:49598      127.0.0.1:8020
|   TCP  127.0.0.1:49599      127.0.0.1:8020
|   TCP  127.0.0.1:49600      127.0.0.1:8020
|   TCP  127.0.0.1:49601      127.0.0.1:8020
|   TCP  127.0.0.1:49602      127.0.0.1:8020
|   TCP  127.0.0.1:49603      127.0.0.1:8020
|   TCP  127.0.0.1:49604      127.0.0.1:8020
|   TCP  127.0.0.1:49605      127.0.0.1:8020
|   TCP  127.0.0.1:49606      127.0.0.1:8020
|   TCP  192.168.56.102:139   0.0.0.0:0
|   TCP  192.168.56.102:9300  192.168.56.102:49180
|   TCP  192.168.56.102:9300  192.168.56.102:49181
|   TCP  192.168.56.102:9300  192.168.56.102:49182
|   TCP  192.168.56.102:9300  192.168.56.102:49183
|   TCP  192.168.56.102:9300  192.168.56.102:49184
|   TCP  192.168.56.102:9300  192.168.56.102:49185
|   TCP  192.168.56.102:9300  192.168.56.102:49186
|   TCP  192.168.56.102:9300  192.168.56.102:49187
|   TCP  192.168.56.102:9300  192.168.56.102:49188
|   TCP  192.168.56.102:9300  192.168.56.102:49189
|   TCP  192.168.56.102:9300  192.168.56.102:49190
|   TCP  192.168.56.102:9300  192.168.56.102:49191
|   TCP  192.168.56.102:9300  192.168.56.102:49192
|   TCP  192.168.56.102:49180 192.168.56.102:9300
|   TCP  192.168.56.102:49181 192.168.56.102:9300
|   TCP  192.168.56.102:49182 192.168.56.102:9300
|   TCP  192.168.56.102:49183 192.168.56.102:9300
|   TCP  192.168.56.102:49184 192.168.56.102:9300
|   TCP  192.168.56.102:49185 192.168.56.102:9300
|   TCP  192.168.56.102:49186 192.168.56.102:9300
|   TCP  192.168.56.102:49187 192.168.56.102:9300
|   TCP  192.168.56.102:49188 192.168.56.102:9300
|   TCP  192.168.56.102:49189 192.168.56.102:9300
|   TCP  192.168.56.102:49190 192.168.56.102:9300
|   TCP  192.168.56.102:49191 192.168.56.102:9300
|   TCP  192.168.56.102:49192 192.168.56.102:9300
|   UDP  0.0.0.0:161          *:*
|   UDP  0.0.0.0:500          *:*
|   UDP  0.0.0.0:4500         *:*
|   UDP  0.0.0.0:5353         *:*
|   UDP  0.0.0.0:5355         *:*
|   UDP  0.0.0.0:33848        *:*
|   UDP  0.0.0.0:54328        *:*
|   UDP  192.168.56.102:137   *:*
|_  UDP  192.168.56.102:138   *:*
```