# Descubrimiento con Amap

## Concepto

**Amap** (Application Mapper) es una herramienta de identificación de servicios que utiliza técnicas de "banner grabbing" y sondeo de aplicaciones. Su principal uso es **verificar y complementar** los resultados obtenidos con nmap.

### Diferencia con nmap -sV

Mientras que `nmap -sV` identifica servicios basándose en firmas y respuestas específicas, amap utiliza un enfoque diferente enviando triggers de aplicación y analizando las respuestas. Esto puede detectar servicios que nmap no identifica correctamente o confirmar falsos positivos.

---

## Flujo de trabajo típico

1. Escanear con nmap y exportar resultados
2. Usar amap para verificar/complementar la identificación de servicios

---

## Comandos

### Generar archivo compatible con amap desde nmap

```bash
sudo nmap -v --reason -sS -oA <nombre_base> <host>
```

Ejemplo: `sudo nmap -v --reason -sS -oA servicios.amap 192.168.56.101`

El flag `-oA` genera la salida en los tres formatos principales:
- `servicios.amap.gnmap` - Formato "grepeable" (el que usa amap)
- `servicios.amap.nmap` - Formato legible
- `servicios.amap.xml` - Formato XML

---

### Identificar servicios con amap

```bash
amap -i <archivo.gnmap> -B
```

Ejemplo: `amap -i servicios.amap.gnmap -B`

| Flag | Descripción |
|------|-------------|
| `-i` | Lee los hosts/puertos desde un archivo en formato gnmap |
| `-B` | Modo "banner grabbing" - obtiene y muestra los banners de los servicios |

Amap se conecta a cada puerto abierto detectado por nmap, obtiene el banner del servicio y lo muestra para ayudar a identificar qué aplicación está ejecutándose.

